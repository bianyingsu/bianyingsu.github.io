"use strict";(self.webpackChunktest=self.webpackChunktest||[]).push([[261],{7065(t,e,n){n.r(e),n.d(e,{comp:()=>i,data:()=>l});var a=n(641);const o={},i=(0,n(6262).A)(o,[["render",function(t,e){return(0,a.uX)(),(0,a.CE)("div",null,[...e[0]||(e[0]=[(0,a.Fv)('<p>&lt;%* const content = tp.file.content; // 获取当前番剧文件的内容 console.log(&quot;当前番剧文件内容:&quot;, content); // 调试输出：当前番剧文件内容</p><p>// 匹配导演字段，提取导演名字 const regex = /导演\\s*[:：]\\s*-?\\s*(.*)/; // 允许有或没有 &quot;-&quot; 的情况 const match = content.match(regex);</p><p>if (match &amp;&amp; match[1]) { let directorName = match[1].trim(); // 获取导演名字，并去除多余空格 directorName = directorName.replace(/[&quot;&#39;]/g, &quot;&quot;); // 去掉可能的引号 console.log(&quot;匹配到的导演名字:&quot;, directorName); // 调试输出：导演名字</p><pre><code>// 获取导演文件夹路径（根据需要修改路径）\nconst folderPath = &quot;番剧相关/Anime Element/（动画业界名人堂）/（导演）/&quot;; \nconst files = app.vault.getFiles();\n\nlet foundFile = null;\n\n// 循环检查导演文件夹中的文件\nfor (const file of files) {\n    if (file.path.startsWith(folderPath)) {\n        const fileContent = await app.vault.read(file);\n        console.log(`检查文件: ${file.name}`); // 调试输出：当前检查的文件名\n\n        const titlePattern = `# 「${directorName}」的导演作品`;\n        const dataviewPattern = `WHERE contains(导演, &quot;${directorName}&quot;)`;\n\n        if (fileContent.includes(titlePattern) || fileContent.includes(dataviewPattern)) {\n            foundFile = file;\n            console.log(&quot;找到匹配的文件:&quot;, file.name); \n            break; \n        }\n    }\n}\n\nif (foundFile) {\n    const fileNameWithoutExt = foundFile.name.replace(&quot;.md&quot;, &quot;&quot;); \n    const filePath = foundFile.path; \n    console.log(&quot;目标导演文件路径:&quot;, filePath); \n\n    let fileContent = await app.vault.read(foundFile);\n    const dataviewPattern = /```dataview([\\s\\S]*?)```/; \n\n    const dataviewMatch = fileContent.match(dataviewPattern);\n\n    if (dataviewMatch) {\n        const beforeDataview = fileContent.substring(0, dataviewMatch.index + dataviewMatch[0].length);\n        const afterDataview = fileContent.substring(dataviewMatch.index + dataviewMatch[0].length);\n\n        if (!fileContent.includes(`[[${tp.file.title}]]`)) {\n            const updatedContent = beforeDataview + `\\n\\n` + afterDataview + `\\n[[${tp.file.title}]]\\n`;\n            await app.vault.modify(foundFile, updatedContent);\n            tR += `导演文件 &quot;[[${fileNameWithoutExt}]]&quot; 已存在，已将番剧添加到 [[${fileNameWithoutExt}]] \\n`;\n        } else {\n            tR += `导演文件 &quot;[[${fileNameWithoutExt}]]&quot; 已存在，但番剧 [[${tp.file.title}]] 已在列表中，无需重复添加。\\n`;\n        }\n    }\n} else {\n    const newFileName = `导演_${directorName}.md`;\n    const newFilePath = folderPath + newFileName;\n\n    if (!app.vault.getAbstractFileByPath(newFilePath)) {\n        console.log(&quot;创建新的导演文件:&quot;, newFilePath); \n\n        // 创建新的文件内容，调整顺序\n        const newFileContent = `---\n</code></pre><h2 id="封面链接-rgn评分-tags-anime-导演" tabindex="-1"><a class="header-anchor" href="#封面链接-rgn评分-tags-anime-导演"><span>封面链接: RGN评分: tags: Anime/导演</span></a></h2><h1 id="「-directorname-」的导演作品" tabindex="-1"><a class="header-anchor" href="#「-directorname-」的导演作品"><span>「${directorName}」的导演作品</span></a></h1><p>```dataview TABLE WITHOUT ID file.link AS &quot;番剧&quot;,RGN评分, &quot;<img src="&quot; + 封面链接 + &quot;" style="width:75px;">&quot; AS 封面 SORT RGN评分 DESC WHERE contains(导演, &quot;${directorName}&quot;) ```</p><p>[[${tp.file.title}]] `;</p><pre><code>        await app.vault.create(newFilePath, newFileContent);\n        tR += `未找到导演文件：已创建新文件 [[导演_${directorName}]] 并添加当前番剧。\\n`;\n    }\n}\n</code></pre><p>} else { tR += <code>未在当前番剧文件中找到导演字段。\\n</code>; } %&gt;</p>',10)])])}]]),l=JSON.parse('{"path":"/guide/%E5%AF%BC%E6%BC%94createLink.html","title":"「${directorName}」的导演作品","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"封面链接:RGN评分:tags: Anime/导演","slug":"封面链接-rgn评分-tags-anime-导演","link":"#封面链接-rgn评分-tags-anime-导演","children":[]}],"git":{"updatedTime":1767779080000,"contributors":[{"name":"wuyuying","username":"wuyuying","email":"wuyuying@foresee.com.cn","commits":1,"url":"https://github.com/wuyuying"}],"changelog":[{"hash":"5e230706cc83dcf9722636f72cdaae7328059447","time":1767779080000,"email":"wuyuying@foresee.com.cn","author":"wuyuying","message":"test"}]},"filePathRelative":"guide/导演createLink.md","excerpt":"<p>&lt;%*\\nconst content = tp.file.content; // 获取当前番剧文件的内容\\nconsole.log(\\"当前番剧文件内容:\\", content); // 调试输出：当前番剧文件内容</p>\\n<p>// 匹配导演字段，提取导演名字\\nconst regex = /导演\\\\s*[:：]\\\\s*-?\\\\s*(.*)/; // 允许有或没有 \\"-\\" 的情况\\nconst match = content.match(regex);</p>\\n<p>if (match &amp;&amp; match[1]) {\\nlet directorName = match[1].trim(); // 获取导演名字，并去除多余空格\\ndirectorName = directorName.replace(/[\\"\']/g, \\"\\"); // 去掉可能的引号\\nconsole.log(\\"匹配到的导演名字:\\", directorName); // 调试输出：导演名字</p>"}')}}]);