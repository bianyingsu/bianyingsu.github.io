"use strict";(self.webpackChunktest=self.webpackChunktest||[]).push([[242],{7655(n,s,a){a.r(s),a.d(s,{comp:()=>e,data:()=>l});var p=a(641);const t={},e=(0,a(6262).A)(t,[["render",function(n,s){return(0,p.uX)(),(0,p.CE)("div",null,[...s[0]||(s[0]=[(0,p.Fv)('<h1 id="excel" tabindex="-1"><a class="header-anchor" href="#excel"><span>Excel</span></a></h1><hr><p>aliases:</p><ul><li>excel 标题: excel</li></ul><hr><p><strong>opencsv解析文件</strong></p><p><strong>笔记本：</strong> excel</p><p><strong>创建时间：</strong> 2021/11/16 11:43 <strong>更新时间：</strong> 2023/6/5 11:13</p><p><strong>作者：</strong> 彼岸樱速</p><p><strong>opencsv解析文件</strong></p><p>文件导入数据库，excel可以用easyexcel实现，csv则可以用opencsv。（本来excel的写好了，又突然说换csv 格式）</p><p>研究了下，比较简单，优点是csv文件体积小，占用内存小（需求改就是因为这个），里面是用多线程读取和 转换为bean的。</p><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span></span>\n<span class="line">                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.opencsv<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>\n<span class="line">                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>opencsv<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>\n<span class="line">                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span></span>\n<span class="line"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CsvTest</span> <span class="token punctuation">{</span></span>\n<span class="line">    <span class="token annotation punctuation">@Test</span></span>\n<span class="line">    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">simpleRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">CsvValidationException</span> <span class="token punctuation">{</span></span>\n<span class="line">        <span class="token class-name">InputStream</span> ins <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;test1.csv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">        <span class="token class-name">CSVReader</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CSVReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>ins<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> record<span class="token punctuation">;</span></span>\n<span class="line">        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>record <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">readNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>\n<span class="line">            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">        <span class="token punctuation">}</span></span>\n<span class="line">    <span class="token punctuation">}</span></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line">    <span class="token annotation punctuation">@Test</span></span>\n<span class="line">    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testcsv1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>\n<span class="line">        <span class="token class-name">InputStream</span> ins <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;test1.csv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CvsBean</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token class-name">CsvUtils</span><span class="token punctuation">.</span><span class="token function">parseCsvToList</span><span class="token punctuation">(</span>ins<span class="token punctuation">,</span> <span class="token class-name">CvsBean</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">    <span class="token punctuation">}</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CsvUtils</span> <span class="token punctuation">{</span></span>\n<span class="line">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">parseCsvToList</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> ins<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">        <span class="token class-name">InputStreamReader</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>ins<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line">　　　　　<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CsvToBeanBuilder</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span></span>\n<span class="line">            <span class="token punctuation">.</span><span class="token function">withType</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span></span>\n<span class="line">            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>\n<span class="line">            <span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line">        <span class="token comment">/*BeanVerifier beanVerifier = new BeanVerifier&lt;CvsBean&gt;() {</span>\n<span class="line">            @Override</span>\n<span class="line">            public boolean verifyBean(CvsBean bean) throws CsvConstraintViolationException {</span>\n<span class="line">                //name张三的记录过滤</span>\n<span class="line">                return !bean.getName().equals(&quot;张三&quot;);</span>\n<span class="line">            }</span>\n<span class="line">        };</span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line">        HeaderColumnNameMappingStrategy&lt;T&gt; mappingStrategy = new HeaderColumnNameMappingStrategy&lt;&gt;();</span>\n<span class="line">        mappingStrategy.setType(clazz);</span>\n<span class="line">        List&lt;T&gt; list = new CsvToBeanBuilder&lt;T&gt;(reader)</span>\n<span class="line">            .withMappingStrategy(mappingStrategy)</span>\n<span class="line">            .withSeparator(&#39;,&#39;)</span>\n<span class="line">            .withVerifier(beanVerifier)</span>\n<span class="line">            .build()</span>\n<span class="line">            .parse();*/</span></span>\n<span class="line">        <span class="token keyword">return</span> list<span class="token punctuation">;</span></span>\n<span class="line">    <span class="token punctuation">}</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span>\n<span class="line"><span class="token annotation punctuation">@ToString</span></span>\n<span class="line"><span class="token annotation punctuation">@Data</span></span>\n<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CvsBean</span> <span class="token punctuation">{</span></span>\n<span class="line">    <span class="token comment">//column 文件流的column值，required :true 文件流必须包含此属性的列，否则报错</span></span>\n<span class="line">    <span class="token annotation punctuation">@CsvBindByName</span><span class="token punctuation">(</span>column <span class="token operator">=</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token class-name">String</span> testaaaa<span class="token punctuation">;</span></span>\n<span class="line">    <span class="token annotation punctuation">@CsvBindByName</span><span class="token punctuation">(</span>column <span class="token operator">=</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token class-name">String</span> name<span class="token punctuation">;</span></span>\n<span class="line">    <span class="token annotation punctuation">@CsvBindByName</span><span class="token punctuation">(</span>column <span class="token operator">=</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token class-name">Integer</span> age<span class="token punctuation">;</span></span>\n<span class="line">    <span class="token annotation punctuation">@CsvBindByName</span><span class="token punctuation">(</span>column <span class="token operator">=</span> <span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token class-name">String</span> address<span class="token punctuation">;</span></span>\n<span class="line">    <span class="token annotation punctuation">@CsvBindByName</span><span class="token punctuation">(</span>column <span class="token operator">=</span> <span class="token string">&quot;sex&quot;</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token class-name">String</span> sex<span class="token punctuation">;</span></span>\n<span class="line">    <span class="token comment">// @CsvBindByName(column = &quot;sadfsex&quot;, required = false)</span></span>\n<span class="line">    <span class="token comment">//文件流无，值为null</span></span>\n<span class="line">    <span class="token class-name">String</span> sadfsex<span class="token punctuation">;</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">test.csv　　//测试文件</span>\n<span class="line">test,name,age,address,sex</span>\n<span class="line">12,张三,23,asdf,难</span>\n<span class="line">as,李四,23,a是否,难</span>\n<span class="line">asd,王五,144,阿道夫,女</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意文件格式，csv文件格式为utf8编码格式，不注意会出问题！！！</p><p>数据全部解析到list中，如果数据量太大也得注意下！里面应该有解析多少行数据的选项。</p><p><img src="/img/excel.pdf-1-1.png" alt="excel.pdf-1-1.png"></p><p>-------------------------------分割线--------------------------------------------------</p><p>再贴两个工具类，用于解析大文件，防止oom等，操作数据库时间超时</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CsvUtils</span> <span class="token punctuation">{</span></span>\n<span class="line">    <span class="token keyword">static</span> <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token constant">BATCH_COUNT</span> <span class="token operator">=</span> <span class="token number">3000</span><span class="token punctuation">;</span></span>\n<span class="line">     </span>\n<span class="line">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">parseCsvToList</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> ins<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> clazz<span class="token punctuation">,</span> <span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> consumer<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">        <span class="token class-name">List</span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token constant">BATCH_COUNT</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">        <span class="token class-name">InputStreamReader</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>ins<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">        <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> iterator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CsvToBeanBuilder</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span></span>\n<span class="line">                <span class="token punctuation">.</span><span class="token function">withType</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span></span>\n<span class="line">                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>\n<span class="line">                <span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">         </span>\n<span class="line">        <span class="token keyword">while</span> <span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>\n<span class="line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token constant">BATCH_COUNT</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>\n<span class="line">                consumer<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">                list<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">            <span class="token punctuation">}</span></span>\n<span class="line">            <span class="token class-name">T</span> next <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">        <span class="token punctuation">}</span></span>\n<span class="line">         </span>\n<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>\n<span class="line">            consumer<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">        <span class="token punctuation">}</span></span>\n<span class="line">    <span class="token punctuation">}</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>//</code> 测试方法</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line"> CsvUtils.parseCsvToList(ins,CvsBean.class,s -&gt; testDao.Insert(s));</span>\n<span class="line"></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>另外再贴个easyexcel的工具包，一样的操作，其他细节忽略了</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EasyExcelUtil</span> <span class="token punctuation">{</span></span>\n<span class="line">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">AnalysisEventListener</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">getListener</span><span class="token punctuation">(</span><span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> consumer<span class="token punctuation">,</span><span class="token keyword">final</span> <span class="token keyword">int</span> batchCount<span class="token punctuation">)</span><span class="token punctuation">{</span></span>\n<span class="line">        <span class="token class-name">AnalysisEventListener</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> analysisEventListener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnalysisEventListener</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">            <span class="token class-name">List</span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span>batchCount<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line"> </span>\n<span class="line">            <span class="token annotation punctuation">@Override</span></span>\n<span class="line">            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">,</span> <span class="token class-name">AnalysisContext</span> analysisContext<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">                list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">                <span class="token keyword">if</span> <span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> batchCount<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">                    consumer<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">                    list<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">                <span class="token punctuation">}</span></span>\n<span class="line">            <span class="token punctuation">}</span></span>\n<span class="line"> </span>\n<span class="line">            <span class="token annotation punctuation">@Override</span></span>\n<span class="line">            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doAfterAllAnalysed</span><span class="token punctuation">(</span><span class="token class-name">AnalysisContext</span> analysisContext<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">                <span class="token keyword">if</span> <span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">                    consumer<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">                <span class="token punctuation">}</span></span>\n<span class="line">            <span class="token punctuation">}</span></span>\n<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">;</span></span>\n<span class="line">        <span class="token keyword">return</span> analysisEventListener<span class="token punctuation">;</span></span>\n<span class="line">    <span class="token punctuation">}</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">//测试方法</span>\n<span class="line">EasyExcel.read(fileName, Dtodata.class, EasyExcelUtil.getListener(list -&gt; demoDAO.save(list),3000))</span>\n<span class="line">.sheet()</span>\n<span class="line">.doRead();</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',26)])])}]]),l=JSON.parse('{"path":"/guide/excel.html","title":"Excel","lang":"zh-CN","frontmatter":{},"headers":[],"git":{"updatedTime":1767871516000,"contributors":[{"name":"wuyuying","username":"wuyuying","email":"wuyuying@foresee.com.cn","commits":1,"url":"https://github.com/wuyuying"}],"changelog":[{"hash":"ee5d0632cbd083664ebce877a780c610058b5abb","time":1767871516000,"email":"wuyuying@foresee.com.cn","author":"wuyuying","message":"excel"}]},"filePathRelative":"guide/excel.md","excerpt":"\\n<hr>\\n<p>aliases:</p>\\n<ul>\\n<li>excel\\n标题: excel</li>\\n</ul>\\n<hr>\\n<p><strong>opencsv解析文件</strong></p>\\n<p><strong>笔记本：</strong> excel</p>\\n<p><strong>创建时间：</strong> 2021/11/16 11:43 <strong>更新时间：</strong> 2023/6/5 11:13</p>\\n<p><strong>作者：</strong> 彼岸樱速</p>\\n<p><strong>opencsv解析文件</strong></p>\\n<p>文件导入数据库，excel可以用easyexcel实现，csv则可以用opencsv。（本来excel的写好了，又突然说换csv\\n格式）</p>"}')}}]);